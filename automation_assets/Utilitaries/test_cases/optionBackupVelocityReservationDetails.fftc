<?xml version="1.0"?>
<testCase version="8.7.0.202112151246">
    <general>
        <language>Python</language>
    </general>
    <execution>
        <parameters version="8.7.0.202112151246">
            <parameters escape="true">
                <parameters xmlns:pt="http://www.fnfr.com/schemas/parameterTree">
                    <backup_path pt:description="Backup folder path for velocity agent">C:/Users/spirent/Documents/velocity_backup/</backup_path>
                    <backup_folder pt:description="Backup folder generic name (timestamp is added dynamically)">velocityBackup</backup_folder>
                    <tftp_server pt:description="VDS tftp server">10.210.107.20</tftp_server>
                    <email>
                        <smtp_server>10.210.107.70</smtp_server>
                        <user>silviu</user>
                        <password>fortinet</password>
                        <send_from>velocity@fortinet.com</send_from>
                    </email>
                </parameters>
            </parameters>
        </parameters>
    </execution>
    <procedures>
        <item name="main">
            <steps>
                <item guid="0410e236-1fd5-4ae8-a2dd-61a4eff5ea0c" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Initialization</body>
                    </command>
                    <nestedSteps>
                        <item guid="dd1e5a67-fa1e-4234-a7b2-8e384bde1ed9" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>import time</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="30ec57e3-2244-4b75-9b47-a9f905e5f7d4" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>import datetime</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="fb15f26b-1c0b-4cd6-9e45-4306861a6cc7" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>timestamp = time.time(); print(timestamp)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="4d4dc5e9-0c9e-4e54-85ee-15cafa941dac" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>timestamp = int(timestamp)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6eff5894-8e60-4f75-ab13-d1f399824a84" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>timestamp = datetime.datetime.utcfromtimestamp(timestamp); print(timestamp)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7d9e0b6e-673a-4b16-9d87-d61d303928e2" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>timestamp = timestamp.strftime(&quot;%Y-%m-%d_%H_%M_%S&quot;); print(timestamp)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="22577edb-28b0-46f7-9abc-949a9e84a2ae" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>reservationId = velocity(&quot;reservationId&quot;); print(reservationId)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="115692f6-fc25-48c2-8007-f90f97a32567" action="eval" skip="true" useFieldsInCommand="false">
                            <command>
                                <body>reservationId = &quot;114f7e1c-eb51-4695-814d-404047ae7933&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="80834f8f-cad3-4b8d-8afb-b931e983a991" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>report_folder_name = param(&apos;backup_folder&apos;) + &quot;_&quot; + str(timestamp); print(report_folder_name)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="60f34ce6-6dfd-494c-8543-9502dfbcf6e6" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>report_path = param(&apos;backup_path&apos;) + str(report_folder_name); print(report_path)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="cf4ec927-68ae-46ef-ad1d-2fe1d0bec9bf" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>tftp_server = param(&apos;tftp_server&apos;)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="26f3f796-db1a-41d1-8d6b-e7938bd49d28" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>init variables</body>
                            </command>
                            <nestedSteps>
                                <item guid="bd828753-0c29-4dda-9c2c-1a38b1d4ab97" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>backup_dict = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="43e51661-f67a-452a-911e-e1b256d065ad" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>parent_resource_ids = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="35b68ce5-fe9c-4e1a-8bbf-908bc4c4a717" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>resource_ids = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="177ee87c-c59d-4672-b6de-1183c535f317" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>devices_names = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e882a259-858b-4156-8ce6-606bfa339e5c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>devices_ip_addresses = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="ebb79b6f-50e5-4db3-ab10-564f0602a90a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>device_port_dict = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e93cdee7-a75a-4fb5-82af-9185f0b63cb4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>port_vlan_dict = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e1f04b4a-aabc-432e-9473-ee3d128aee45" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>vlan_info = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dd7407c3-0961-4517-bcde-3b60e9cfd323" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>attachments = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="204d0fcb-78a6-41cc-aaf0-b1eba5bdc88d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>dict_resources = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ebd297b8-0a53-479f-8175-f08de99113ef" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>init report </body>
                            </command>
                            <nestedSteps>
                                <item guid="b2a742c7-280e-4eec-af72-9a0dd69a5bb9" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>exec_timestamp = info(&apos;timestamp&apos;); print(exec_timestamp)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="2f2b6447-e9ad-4859-928b-04aba5a1d5dc" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.mkdir(report_path)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="2e49afda-4349-4321-8d3e-850a4573f282" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_name = &quot;reservationSummary&quot; + &quot;_&quot; + str(timestamp) + &quot;.html&quot;; print(report_name)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d5be5429-84e8-4801-89c4-c157536e2ecf" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_html = str(report_path) + &quot;/&quot; + str(report_name); print(report_html)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="927a57b8-3eb7-429b-ac23-e00f0f9cb843" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>init email</body>
                            </command>
                            <nestedSteps>
                                <item guid="524a98b9-9e9d-4adf-a4f2-254b2e43dd7c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>email_smtp_server = param(&apos;email/smtp_server&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6bf975c8-a870-4d86-beec-4b51fc4f4d24" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>email_user = param(&apos;email/user&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d99b1d8f-94d7-4199-badf-1a163c11368c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>email_password = param(&apos;email/password&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="08fc89a2-5d63-478f-9b6f-69060b84f1c4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>email_send_from = param(&apos;email/send_from&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="0a3c04d9-0744-4225-b943-94af89654b52" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Open velocity session</body>
                    </command>
                    <nestedSteps>
                        <item guid="a7b8a35e-9a4b-4fd9-b6a8-164537975c76" action="open" session="velocity" useFieldsInCommand="false">
                            <command>
                                <body>application:com.fnfr.itest.applications.webservices.restful</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulSessionProperties" url="https://10.210.107.10" url.inherit="false" version="2" version.inherit="false">
                                    <authentication transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.AuthenticationProperties" authenticationType="Basic" authenticationType.inherit="false" user="superadmin" user.inherit="false" password.masked="false" password="superadmin" password.inherit="false" acceptAllCertificates="true" acceptAllCertificates.inherit="false"/>
                                </sessionProperties>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="002e3ed6-5180-481b-af2e-ca82b2bee433" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Get reservation details</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>Get reservation details:</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="fec7bafe-3a3c-4105-a8cc-8c3368483dcf" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get reservation information</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get reservation information</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="23cb607c-e3a1-4349-84cb-c832f186fe67" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]?limit=200</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/creatorId</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>creator_id</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/start</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>reservation_start</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/end</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>reservation_end</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/name</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>reservation_name</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/topologyId</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>topology_id</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]?limit=200" action.inherit="false"/>
                                </item>
                                <item guid="7b09d180-3194-49b0-9e91-222c68eb1e9e" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/user/v9/profile/[creator_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/name</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>user_name</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/role</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>user_role</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/email</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>user_email</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/user/v9/profile/[creator_id]" action.inherit="false"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="54a25dd7-07d5-4d1f-b461-89f2e0bdd2b9" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get topology information and save tbml file</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get topology information and save tbml file</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="4acfc19b-ad53-4d17-be39-ac747a2f205e" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]/topology?limit=200</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Xml/tbml/header/name</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>topology_name</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Xml/tbml/header/description</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>topology_description</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                        <storeResponseAt>topology_tbml</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]/topology?limit=200" action.inherit="false"/>
                                </item>
                                <item guid="0a84d8f6-7123-46d6-a252-dfa7c00a58cf" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/topology/v16/topology/[topology_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/creatorId</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>creator_id</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>tags()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>topology_tags</storageLocation>
                                                        <storeInAList>true</storeInAList>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/topology/v16/topology/[topology_id]" action.inherit="false"/>
                                </item>
                                <item guid="3a1cc899-70bc-49b8-a6ae-342ff34dab5c" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/user/v9/profile/[creator_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/name</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>topology_author</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/user/v9/profile/[creator_id]" action.inherit="false"/>
                                </item>
                                <item guid="f4b13b96-2af7-42fb-917d-cecda61f8108" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>tags = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="749edaf4-8533-480e-b171-ca2760778395" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>tag in topology_tags:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="ac089a2f-7d9d-4897-9d10-4fe578573e84" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>tags = str(tags) + &quot; &quot; + str(tag)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="883a36ee-3900-4681-897e-f6920b4a642e" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Create topology file</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- create topology file</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="ac958222-9575-4c5c-b094-689ba1663920" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topology_name = topology_name.replace(&quot; &quot;, &quot;_&quot;); print(topology_name)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dd228c49-b3a5-471e-bb4f-55d96fa6f4cd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topology_filename = str(topology_name) + &quot;.tbml&quot;; print(topology_filename)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6038bfdd-52ad-4a34-b8c9-c2864916404f" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>attachments = str(attachments) + str(topology_filename)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="2c085d5a-47ff-4419-996a-ece60f28c252" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topo_file_path = str(report_path) + &quot;/&quot; + str(topology_filename); print(topo_file_path)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1cd541fa-694b-4d85-af0e-7464ae6893e2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topo_file = open((topo_file_path), &quot;w+&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1bd2471b-9b2b-4909-81f8-055e10a65e2e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topo_file.write(topology_tbml)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b2b4ab2a-2215-47b3-b081-ba0fb6728856" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>topo_file.close()</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5606c6dc-b697-4a44-bda1-1577251acda5" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get topology resources ids</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get topology resources ids</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="a3b6846e-2459-4775-86cb-688e859678c5" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                    <command>
                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/items/*/inventoryResourceId</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>resources_names</storageLocation>
                                                        <storeInAList>true</storeInAList>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>mapped/Json/items/*/type</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>resources_types</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200" action.inherit="false"/>
                                </item>
                                <item guid="ce7ea708-0339-47d3-b0bb-db292daf5b45" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>name, type in zip(resources_names, resources_types):</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="239e9353-eb11-40fe-9855-aad38077826e" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>dict_resources[name] = type</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f4442985-db2a-4e8f-8b0d-19ccb235e8d4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(dict_resources)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a7028650-189c-413a-90e9-7842c6916e94" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>name in dict_resources:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="5c0604f4-f2ad-40eb-af4e-00d5b6380fe1" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>dict_resources[name] == &quot;DEVICE&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="5ec60742-664e-4c2b-935a-1c1286f534c2" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">mapped/Json/items/*\\[inventoryResourceId = &quot;[name]&quot;]/inventoryResourceId</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>resource_id</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="94b540aa-86bf-445a-a9d0-e389037d367e" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>resource_ids.append(resource_id)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="f47ab50b-606f-405d-9b2a-f6ff0f8e621f" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>dict_resources[name] == &quot;PORT&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="2ba8af26-d0f6-4bc2-b012-38c22ea48731" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">mapped/Json/items/*\\[inventoryResourceId = &quot;[name]&quot;]/inventoryParentResourceId</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>parent_resource_id</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/items/*[type = &quot;PORT&quot;]/name</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>ports_names</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="1f237b2f-41de-4fee-8bec-805f84beb729" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>parent_resource_ids.append(parent_resource_id)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8f3890a0-c944-4bd3-ae60-6865e35f46fc" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(parent_resource_ids)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a8ff43f4-c44c-4eb3-8443-320043060e1a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(ports_names)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3ec8ad75-46d1-4c1d-84c4-bfaae289aafa" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(resource_ids)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="49ab9600-7d6d-4a57-8209-267d02b8a3fd" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get topology ports names and parent devices names</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get topology ports names and parent devices names</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="a34036ef-69a5-492d-a193-dd911aa3d615" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>id in parent_resource_ids:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="a2ef4c71-4132-40d7-9676-9eb0918ecbcf" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                            <command>
                                                <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/name</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>device_name</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                        </item>
                                        <item guid="1d97e68a-d3e0-4a1a-a4cc-8324ef043420" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>devices_names.append(device_name)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="912df75f-6dfa-49b9-99e9-9a5258a39464" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(devices_names)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="fb64a280-09d6-47d5-a77e-b4d2232b3745" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>device, port in zip(devices_names, ports_names):</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="5e0a2e92-e379-4ab5-8db2-dc8fa79e6b98" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>device in device_port_dict.keys():</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="6a791b0c-0905-47b0-8828-7052bdbe681f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>device_port_dict[device] = str(device_port_dict[device]) + &quot; &quot; + str(port)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b5c6cc25-8d34-4eb4-b2ba-ed8a07781f62" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="89d33dc1-7111-4677-9248-6a695fbbe7c2" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>device_port_dict[device] = port</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c6dea92e-fc23-46b8-81e8-911da4e92a6b" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(device_port_dict)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f9140d50-68c2-4bc6-b8a2-9e2d97164b24" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get topology devices ip addresses</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get topology devices ip addresses</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="67c725a2-8674-493d-a8e1-f5fc5c242c3a" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>id in parent_resource_ids:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="2f17b697-ccfd-4647-90bb-4e39c8866be2" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                            <command>
                                                <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/properties/item[name = &quot;ipAddress&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>device_ip_addr</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                        </item>
                                        <item guid="94b58b6c-3574-4afe-9c09-90c49ac46a1b" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>devices_ip_addresses.append(device_ip_addr)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f65cba1f-85f9-4458-9418-8a87b7b32454" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(devices_ip_addresses)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e419fe2a-35ad-4167-bba1-38b714a263da" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get topology vlan information</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get topology vlan information</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="8de9de11-8741-4f6d-8528-6ae299ad895a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>dict_device_vlans = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e396de67-b822-45d1-8a02-193784fd9fef" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>device_name, port_names in device_port_dict.items():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="6533370b-37c7-4a84-b132-443253abefda" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(device_name)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="bc6c1ae6-aba0-4a53-b749-83af62d8b771" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(port_names)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ebf93ede-883b-40ff-a57e-f5c53595b369" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>port_names = port_names.split(&quot; &quot;);print(port_names)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e532916d-46ab-49cf-ba6b-01c446965562" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>port in port_names:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="ef42d85b-93b4-444d-9e90-3c4438a79ad4" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                        <query sub="true">mapped/Json/items/*\\[name = &quot;[port]&quot;]/vlanIds/*/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>vlan_ids</storageLocation>
                                                                        <storeInAList>true</storeInAList>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                        <query sub="true">mapped/Json/items/*\\[name = &quot;[port]&quot;]/vlanIds/*/isTagged</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>vlan_tags</storageLocation>
                                                                        <storeInAList>true</storeInAList>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/reservation/v18/reservation/[reservationId]/resources?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="6786b9ed-7e14-45d7-85a1-4f03ae66302d" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>(str(vlan_ids) != &quot;&quot;) and (str(vlan_tags) != &quot;&quot;):</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="4a4f9a3f-3d3f-4d99-83c6-cb4445f9944d" action="for" useFieldsInCommand="false">
                                                            <command>
                                                                <body>id, tag in zip(vlan_ids, vlan_tags):</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="26f02495-e9cb-48c7-9fd2-b348844d0b02" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>str(tag) == &quot;true&quot;:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="32b8e45e-2de5-40a4-b74d-f7430cada536" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>tag = &quot;tagged&quot;</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="63d81a14-f541-4b20-b3bd-2e903c8e1cb9" action="elif" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>str(tag) == &quot;false&quot;:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="05d3a716-8403-4bb9-9bcd-e5e773a82024" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>tag = &quot;untagged&quot;</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="f5349bd4-0e95-4a80-ac97-cae959258c3c" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>vlan_info = str(vlan_info) + str(id) + &quot;(&quot; + str(tag) + &quot;)&quot; + &quot; &quot;; print(vlan_info)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="ce9f6d18-0790-4fce-bf1a-048c1fb562b5" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>dict_device_vlans[device_name] = str(vlan_info)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="1ef1f5ee-7d98-4da4-b06b-ac3e1b005121" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>vlan_info = &quot;&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="ab01e5b0-0df7-4f15-a2db-6858a64e663e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(dict_device_vlans)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="900e5ee0-aa15-46a5-92e3-3a8ad026ec2d" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Update backup dictionary w/ devices names, ip_addr, ports and vlans information</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- update backup dictionary w/ devices names, ip_addr, ports and vlans information</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="4ce4c1fd-f22d-4d3b-8d65-a365cdae2bd0" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>name, ip_addr in zip(devices_names, devices_ip_addresses):</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="4eea44d2-07fa-40d2-981d-363e27b7000a" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>backup_dict[name]= {&apos;ip_addr&apos; : ip_addr}</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="871ed06f-453a-422e-afc5-4b9855190469" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>backup_dict[name].update({&apos;ports&apos; : &apos;&apos;})</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="9ed995ea-a60d-411d-92ed-705a267bdbed" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>backup_dict[name].update({&apos;vlans&apos; : &apos;&apos;})</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d85ed4bd-661b-4f84-b444-054acf8a808a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(backup_dict)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="07fdc97b-3c8d-4e8f-899f-542472356dfb" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>name, ports in device_port_dict.items():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="71508bcf-6eb2-4593-81ce-69331e9f3667" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>backup_dict[name].update({&apos;ports&apos; : ports})</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9e31bc85-6ad1-461c-8749-505a6d1f4309" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>name, vlans in dict_device_vlans.items():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="2cf4334c-3136-4689-a082-7a8099b52032" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(vlans)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e2caeddf-0ea4-4773-a14c-21e5cc680adc" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>vlan_list = []</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b7d8f74d-8e32-4f47-9143-8508ac50e1bb" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>vlan_list_unique = []</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ba85285d-0c93-4d01-8749-94f54deca21f" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>vlan in vlans.split(&quot; &quot;):</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="644f2bf1-e387-4b2b-a875-7f50eaf886c8" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>vlan != &quot;&quot; and vlan != &quot; &quot;:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="d9417837-7ea8-43bd-91b0-5bf4a6c738ca" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>vlan in vlan_list:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="6b3be09a-1db7-4f71-b133-24f4a29c5a5d" action="comment" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>do nothing</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="0d084007-9698-4a6c-bb70-f9ad2f61f8cd" action="else" useFieldsInCommand="false">
                                                            <nestedSteps>
                                                                <item guid="5a441882-ad00-479a-a85d-d13818f7b7e5" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>vlan_list_unique.append(vlan)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="abe24587-a382-4517-832f-8ae8f92e1c2d" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>vlan_list.append(vlan)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e659e88d-a291-43c5-b151-994cf0c81795" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>backup_dict[name].update({&apos;vlans&apos; : str(vlan_list_unique)[1:-1]}); print(backup_dict)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9ff4d52c-e34d-4504-a35c-c2820c5db181" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(backup_dict)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="6127c7ba-a963-4d29-b96c-61667c1dd87b" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Get configuration files from devices</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>Get configuration files from devices:</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="92219f04-7caa-4660-bba9-c1070711095c" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get devices ids from reservation</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get devices ids from reservation:</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="10beb6b2-7b8e-4dbc-a216-3947b3085121" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(parent_resource_ids)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="03d2409a-bde7-4c59-8c39-61cdabc4ed2d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unique_resource_ids = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="45a4ec28-6746-46e0-b033-979236d35c7c" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>id in parent_resource_ids:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="79f029a7-7ea4-402c-88b7-2f52ba123538" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>id not in unique_resource_ids:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="9348c6ba-8af9-448c-b861-b6cdfdde070d" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>unique_resource_ids.append(id)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9a81c8e5-6cc7-4a43-b92a-06644e8c56b1" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(unique_resource_ids)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="04d14782-9422-44dd-8d89-f64f8f450e30" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get devices tempate names based on device ids</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get devices template names based on device ids:</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="1feb28fa-64ef-4095-ad60-4dc3f2776c20" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>device_template_dict = {}</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8d6ce342-ef3d-4b0e-82a7-ed82b6bcb29b" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>id in unique_resource_ids:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="0cffb20b-cf6a-4615-a2de-b6d8a7cc05d6" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                            <command>
                                                <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/templateId</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>device_template_id</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                        </item>
                                        <item guid="5479aece-0ef5-4e07-ad0a-c53e9546a74e" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                            <command>
                                                <body>/velocity/api/inventory/v16/template/[device_template_id]?limit=200</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/name</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>device_template_name</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/template/[device_template_id]?limit=200" action.inherit="false"/>
                                        </item>
                                        <item guid="5d15050a-06f9-4be0-95ff-d0647eb9cfb7" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>device_template_dict[id] = str(device_template_name)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="bf18fdaa-dedd-433b-b347-c481cf44dfb4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(device_template_dict)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="14eb1f93-8dea-44f5-b6d0-b663fc7a7d04" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get devices credentials, connect and get config</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- get devices credentials, connect and get config:</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="66567e06-3062-4c9b-b194-80a24bfff9b6" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>id, template in device_template_dict.items():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="0a831cd3-b2c1-4fd6-9e0a-9d62d03e7365" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>device_template_dict[id] == &quot;Arista Switch&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="0918ee1c-4f12-4c5f-bf1b-6fe6234fd7e6" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/name</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>arista_name</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>arista_console_ip</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console Port&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>arista_console_port</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;username&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>arista_username</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;password&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>arista_password</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="46e3e2b3-e117-46a8-8a7a-75149ba5afcd" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>connect, get and backup config file via vds</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="9328384e-71b1-46d8-839f-85aff4324d71" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>arista_filename = str(arista_name) + &quot;_&quot; + str(timestamp) + &quot;.cfg&quot;; print(arista_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="50ee9a5f-ac01-4bf3-ad6b-1ce840e4b9f4" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>attachments = str(attachments) + &quot;, &quot; + str(arista_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="895709bb-3cc3-4a43-bf43-1861de234390" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>arista_config_path = str(report_path) + &quot;/&quot; + str(arista_filename); print(arista_config_path)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="be813ffa-66bd-4a5a-ada6-dd3853a243ff" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>arista_config = open((arista_config_path), &quot;w+&quot;)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="7c8cdd91-337c-4540-92a4-834da6c26d74" action="open" session="arista">
                                                            <command>
                                                                <body>project://Arista_console/session_profiles/console.ffsp</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                    <completionProperties>
                                                                        <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                                                    </completionProperties>
                                                                </stepProperties>
                                                                <sessionProperties type="com.fnfr.svt.applications.telnet.documents.TelnetSessionProperties">
                                                                    <ipAddress inherit="false">[arista_console_ip]</ipAddress>
                                                                    <port inherit="false">[arista_console_port]</port>
                                                                </sessionProperties>
                                                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </applicationProperties>
                                                        </item>
                                                        <item guid="292b78e6-57d4-4713-9287-e4a404409a3d" action="consoleLogin" session="arista" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-username [arista_username] -password [arista_password]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ login to &quot;[arista_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ login to &quot;[arista_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="2054b87b-c482-4704-bd70-4b2f438802c4" action="command" session="arista" skip="true">
                                                            <command>
                                                                <body>show running-config</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="none">
                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="message">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                                <message>------ getting configuration...</message>
                                                                                <tag sub="false" defaultValue=""/>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                                <storeResponseAt>arista_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[arista_config_path]</responseFile>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="4bc58ba8-ae9b-45cf-8500-fb89bf72d3b5" action="backupConfigTftp" session="arista" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-tftp [tftp_server] -arista_cfg_name [arista_filename]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ backup config from &quot;[arista_name]&quot; to vds tftp is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ backup config from &quot;[fgt_name]&quot; to vds tftp is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="c9ce986a-5a8f-4547-a1d9-6760fb7eccee" action="consoleExit" session="arista" useFieldsInCommand="false">
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ logout from &quot;[arista_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ logout fgt &quot;[arista_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="a76829fb-d928-410c-8a20-5075c9c1a93b" action="close" session="arista" useFieldsInCommand="false">
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="cffd31df-324b-4b2d-a032-45fe8bc71b2c" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>get config content via vds</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="5814ed4a-8061-4b96-8d18-db830b95599e" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://Utilitaries/libraries/utilitaries_procedures.fftc#getConfigFromVds(config_name=str(arista_filename))</body>
                                                            </command>
                                                            <postProcessing>
                                                                <storeResponseAt>arista_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[arista_config_path]</responseFile>
                                                                <appendRespToFile inherit="false">false</appendRespToFile>
                                                                <appendCommand inherit="false">false</appendCommand>
                                                                <appendTimestamp inherit="false">false</appendTimestamp>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b47f8042-5026-48b8-9b65-1bd675d1f081" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>device_template_dict[id] == &quot;Fortigate Firewall&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="787c331f-f8ac-49f5-8d7f-520b42b01fb2" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/name</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fgt_name</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fgt_console_ip</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console Port&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fgt_console_port</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;username&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fgt_username</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;password&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fgt_password</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="37827fcf-737a-40f9-aa2a-3b09732b94da" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>connect, get and create config file</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="b972908a-5b5d-46bd-9125-aeb9a717b539" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fgt_filename = str(fgt_name) + &quot;_&quot; + str(timestamp) + &quot;.cfg&quot;; print(fgt_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="a5ee6b03-f647-4c2d-9010-7631a1d208cc" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>attachments = str(attachments) + &quot;, &quot; + str(fgt_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="c27e4cae-ebd7-4463-b2a1-5e601db4003d" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fgt_config_path = str(report_path) + &quot;/&quot; + str(fgt_filename); print(fgt_config_path)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="5ac99838-f671-4e2f-bb78-f3d8b19ba705" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fgt_config = open((fgt_config_path), &quot;w+&quot;)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="200da8f5-7dea-4a68-9e97-f94ad0c086ab" action="open" session="fgt" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://Fortigate_console/session_profiles/console.ffsp</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                    <completionProperties>
                                                                        <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                                                    </completionProperties>
                                                                </stepProperties>
                                                                <sessionProperties type="com.fnfr.svt.applications.telnet.documents.TelnetSessionProperties">
                                                                    <ipAddress inherit="false">[fgt_console_ip]</ipAddress>
                                                                    <port inherit="false">[fgt_console_port]</port>
                                                                </sessionProperties>
                                                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </applicationProperties>
                                                        </item>
                                                        <item guid="0536e42d-07f8-4e89-923e-6d2d17dbf9f2" action="consoleLogin" session="fgt" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-username [fgt_username] -password [fgt_password]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ login to &quot;[fgt_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ login to &quot;[fgt_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="4842e107-7661-4c9b-90ff-1b6dbf5f54c4" action="command" session="fgt" skip="true">
                                                            <command>
                                                                <body>show full-configuration</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="none">
                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="message">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                                <message>------ getting configuration...</message>
                                                                                <tag sub="false" defaultValue=""/>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                                <storeResponseAt>fgt_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[fgt_config_path]</responseFile>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                <morePaging>
                                                                    <numPagesToFetch inherit="false">10000</numPagesToFetch>
                                                                </morePaging>
                                                                <promptProperties>
                                                                    <stepPrompts>
                                                                        <item name="prompt2" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                                            <Content sub="true">* #</Content>
                                                                        </item>
                                                                        <item name="prompt4" TypeOfPrompt="MORE">
                                                                            <Content>--More-- </Content>
                                                                        </item>
                                                                    </stepPrompts>
                                                                    <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                                                </promptProperties>
                                                            </applicationProperties>
                                                            <performResponseMapping>false</performResponseMapping>
                                                        </item>
                                                        <item guid="1a1bf2e7-cc38-4438-9a6a-9c05be3fbf21" action="backupConfigTFTP" session="fgt" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-config_name [fgt_filename] -tftp [tftp_server]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ backup config from &quot;[fgt_name]&quot; to vds tftp is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ backup config from &quot;[fgt_name]&quot; to vds tftp is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="1a78fa4f-8483-468a-b3c7-98cde5b393f5" action="consoleExit" session="fgt" useFieldsInCommand="false">
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ logout from &quot;[fgt_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ logout fgt &quot;[fgt_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="16cf40d8-aaf0-40d2-a83f-a9045d58c34c" action="close" session="fgt">
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="c2a6b001-5aef-4840-a801-23f928263a9a" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>get config content via vds</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="a4e469c2-fa0b-4f8f-b369-76125553d296" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://Utilitaries/libraries/utilitaries_procedures.fftc#getConfigFromVds(config_name=str(fgt_filename))</body>
                                                            </command>
                                                            <postProcessing>
                                                                <storeResponseAt>fgt_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[fgt_config_path]</responseFile>
                                                                <appendRespToFile inherit="false">false</appendRespToFile>
                                                                <appendCommand inherit="false">false</appendCommand>
                                                                <appendTimestamp inherit="false">false</appendTimestamp>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ac8c0fae-e792-4602-9bed-7bf24755fbb3" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>device_template_dict[id] == &quot;Fortinet Switch&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="a8c20ba7-2445-464c-b23a-cc264ccaf9ce" action="GET" session="velocity" estimatedStepExecutionTime="0.305">
                                                    <command>
                                                        <body>/velocity/api/inventory/v16/device/[id]?limit=200</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/name</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fsw_name</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fsw_console_ip</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;Console Port&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fsw_console_port</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;username&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fsw_username</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>mapped/Json/properties/*[name = &quot;password&quot;]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>fsw_password</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.fnfr.itest.applications.webservices.restful" transferableType="com.fnfr.itest.applications.webservices.properties.restful.RESTfulInvokeProperties" httpMethod="GET" httpMethod.inherit="false" action="/velocity/api/inventory/v16/device/[id]?limit=200" action.inherit="false"/>
                                                </item>
                                                <item guid="f1e6e323-3b3c-4dbe-9901-c2e50b0df0f5" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>connect, get and create config file</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="2a6d6113-ff84-4944-bcab-7747f12f628a" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fsw_filename = str(fsw_name) + &quot;_&quot; + str(timestamp) + &quot;.cfg&quot;; print(fsw_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="cf1bf2e3-d4f6-4a2e-9c29-aa5806096a83" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>attachments = str(attachments) + &quot;, &quot; + str(fsw_filename)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="4ea12c7a-cd10-4170-b48c-22bc44e78303" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fsw_config_path = str(report_path) + &quot;/&quot; + str(fsw_filename); print(fsw_config_path)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="69e855c2-b645-4a0b-963a-8439fafffa09" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fsw_config = open((fsw_config_path), &quot;w+&quot;)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="c4dd96b3-5f37-42a6-a4c5-ba05bbcb8926" action="open" session="fsw" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://Fortiswitch_console/session_profiles/console.ffsp</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                    <completionProperties>
                                                                        <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                                                    </completionProperties>
                                                                </stepProperties>
                                                                <sessionProperties type="com.fnfr.svt.applications.telnet.documents.TelnetSessionProperties">
                                                                    <ipAddress inherit="false">[fsw_console_ip]</ipAddress>
                                                                    <port inherit="false">[fsw_console_port]</port>
                                                                </sessionProperties>
                                                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </applicationProperties>
                                                        </item>
                                                        <item guid="1bed8a14-34fa-4546-8495-5161e85ff0d2" action="consoleLogin" session="fsw" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-username [fsw_username] -password [fsw_password]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ login to &quot;[fsw_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ login to &quot;[fsw_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="4aba50c0-077a-4062-96dc-ba01ea42dde7" action="command" session="fsw" skip="true">
                                                            <command>
                                                                <body>show full-configuration</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="none">
                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="message">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                                <message>------ getting configuration...</message>
                                                                                <tag sub="false" defaultValue=""/>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                                <storeResponseAt>fgt_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[fsw_config_path]</responseFile>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                <morePaging>
                                                                    <numPagesToFetch inherit="false">10000</numPagesToFetch>
                                                                </morePaging>
                                                                <promptProperties>
                                                                    <stepPrompts>
                                                                        <item name="prompt2" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                                            <Content sub="true">* #</Content>
                                                                        </item>
                                                                        <item name="prompt4" TypeOfPrompt="MORE">
                                                                            <Content>--More-- </Content>
                                                                        </item>
                                                                    </stepPrompts>
                                                                    <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                                                </promptProperties>
                                                            </applicationProperties>
                                                            <performResponseMapping>false</performResponseMapping>
                                                        </item>
                                                        <item guid="f2a32d38-bf99-4564-b285-8cb75426eff2" action="backupConfigTftp" session="fsw" useFieldsInCommand="false">
                                                            <command>
                                                                <body>-cfg_name [fsw_filename] -tftp [tftp_server]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ backup config from &quot;[fsw_name]&quot; to vds tftp is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ backup config from &quot;[fsw_name]&quot; to vds tftp is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                <morePaging>
                                                                    <numPagesToFetch inherit="false">10000</numPagesToFetch>
                                                                </morePaging>
                                                                <promptProperties>
                                                                    <stepPrompts>
                                                                        <item name="prompt2" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                                            <Content sub="true">* #</Content>
                                                                        </item>
                                                                        <item name="prompt4" TypeOfPrompt="MORE">
                                                                            <Content>--More-- </Content>
                                                                        </item>
                                                                    </stepPrompts>
                                                                    <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                                                </promptProperties>
                                                            </applicationProperties>
                                                            <performResponseMapping>false</performResponseMapping>
                                                        </item>
                                                        <item guid="33eab58d-2784-41e9-a034-8913722d8615" action="consoleExit" session="fsw" useFieldsInCommand="false">
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>retCode()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>str(value) == &quot;TRUE&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>------ logout from &quot;[fsw_name]&quot; is ok</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>------ logout fgt &quot;[fsw_name]&quot; is not ok; fail test...</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                        <item guid="6610cab4-5bf3-488d-b363-11f927c7cff3" action="close" session="fsw">
                                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="116c1822-6a4d-4dcd-a3a7-ca9ca1afa9b8" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>get config content via vds</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="0d047214-f64a-4171-929d-4f38255181d8" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://Utilitaries/libraries/utilitaries_procedures.fftc#getConfigFromVds(config_name=str(fsw_filename))</body>
                                                            </command>
                                                            <postProcessing>
                                                                <storeResponseAt>fsw_config</storeResponseAt>
                                                                <storeResponseText>true</storeResponseText>
                                                                <responseFile inherit="false" sub="true">file:/[fsw_config_path]</responseFile>
                                                                <appendRespToFile inherit="false">false</appendRespToFile>
                                                                <appendCommand inherit="false">false</appendCommand>
                                                                <appendTimestamp inherit="false">false</appendTimestamp>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="80467064-bfcf-4a1b-ad50-6cf77b0cb16b" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="5a8bbc40-56ae-4289-8cce-cbeb46531553" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>skip device</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5f200766-62b8-442f-b274-fef5e02a83fe" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build zip archive</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build zip archive</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="b91bf8a7-028a-498b-9e45-6eb49f5caf35" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>backup_directory = param(&apos;backup_path&apos;); print(backup_directory)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5bbbb75c-54b5-4216-991f-0a12d36688cf" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>backup_zip = str(report_folder_name) + &quot;.zip&quot;; print(backup_zip)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e3d8a7b9-634f-4fc2-b60f-f01047fea219" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>import os</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0b85082b-ae89-40a6-a23c-e68a9e534987" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>import zipfile</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="40e23886-85dd-473b-803c-924b23fd7493" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>cwd = os.getcwd(); print(cwd)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7d67f102-6b01-490a-94ff-dadfac3d4074" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.chdir(backup_directory)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b3e89adb-8711-454c-a4e8-6c67b8c87a5d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>nwd = os.getcwd(); print(nwd)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="26f6bc05-5833-41d9-991d-83b0d474ea51" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>zf = zipfile.ZipFile(backup_zip, &quot;w&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c20aaa7e-9834-4297-a921-c6bbf1fa2232" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(os.walk(report_folder_name))</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="446c5e03-ebd8-4465-a112-5336d87f1f19" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>dirname, subdirs, files in os.walk(report_folder_name):</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="63360cc4-7a6e-41c2-b955-66d61b8339a6" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>zf.write(dirname)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b1206ceb-36fc-4a11-b4fa-03df2d9ad2ed" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(dirname)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="6bcb823c-380d-49b3-b3a0-710cceaabfb7" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(files)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="84f8f033-b5fd-42bd-a78e-da79df4c0f08" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>filename in files:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="771c8ae2-61e5-47dc-be65-20b3a10a021f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>zf.write(os.path.join(dirname, filename))</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="692e8b69-0147-4ab4-b429-9daa9692fc4e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>zf.close()</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="813f8c61-c843-4f5d-b995-0af31d594026" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.chdir(cwd)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="ce43e470-5028-4c8b-a4bf-4d2c44180761" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>cwd = os.getcwd(); print(cwd)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="f173b6cd-0268-4175-ab9d-dc624b812b78" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Build html report</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>Build html report:</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="c291ba92-66cf-4bc6-9a7e-3317204772f6" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Create backup report html file</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- create backup report html file</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="15ed73c8-cbbc-4d20-9e15-3b1f540f5a0a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f = open((report_html), &quot;w+&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a6b348ab-1363-4875-9fd8-fb9c707294f8" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_init = &quot;&lt;html&gt;&lt;body&gt;&lt;p style=\\&quot;font-size:2vw;\\&quot;&gt;&lt;b&gt;Velocity Reservation Backup Information Data (&quot; +  str(exec_timestamp) + &quot;)&lt;/b&gt;&lt;/p&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4fcacc08-314f-4413-aefb-ab52c000ffb3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_init)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e69baf87-4e4d-4f8f-b4bb-e57006a1d386" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Reservation Information header</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;reservation information&apos; header</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="44e71158-0b83-4c24-b434-97dbd37c0877" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_reservation_header_prim = &quot;&lt;table border=\\&quot;1|0\\&quot; bgcolor=\\&quot;darkblue\\&quot;&gt;&lt;tr&gt;&lt;th style=\\&quot;color:white\\&quot;&gt;Reservation Information&lt;/th&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a96cccbf-7384-483e-8f6c-e2b89bc8d90c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_reservation_header_sec = &quot;&lt;tr bgcolor=\\&quot;lightblue\\&quot;&gt;&lt;td&gt;Reservation Name&lt;/td&gt;&lt;td&gt;Owner&lt;/td&gt;&lt;td&gt;Start&lt;/td&gt;&lt;td&gt;End&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e4adc8e4-fc47-4326-b5fd-1eccb9ae81ae" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_reservation_header_prim)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8e9b7dbc-a6c8-4854-9e8f-e19315ab7f91" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_reservation_header_sec)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="3ba2cf77-5a27-4b09-aa76-5c6b7fd84d46" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Reservation Information body</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;reservation information&apos; body</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="cdea086d-45ae-440d-a1f0-878f27795739" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_start = int(reservation_start)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="afdf0d3f-88da-4069-b318-96135f780a1a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_end = int(reservation_end)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7481921a-bc6b-4393-9609-d6f76826cc21" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_start = datetime.datetime.fromtimestamp(reservation_start / 1e3); print(reservation_start)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5f200835-6560-41a8-a322-f9719965ab85" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_end = datetime.datetime.fromtimestamp(reservation_end / 1e3); print(reservation_end)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cdec64d4-f12a-4e69-aa68-2c4aa71ea44a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_start = reservation_start.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;); print(reservation_start)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="2138460b-e376-429d-b426-11e46711e722" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>reservation_end = reservation_end.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;); print(reservation_end)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="33a253fc-5339-4b7b-862a-fbb5d0d0956b" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_reservation_body = &quot;&lt;tr bgcolor=\\&quot;white\\&quot;&gt;&lt;td&gt;&quot; + str(reservation_name) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(user_name) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(reservation_start) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(reservation_end) + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="83a00694-1c96-4922-ad31-c66140d3ab09" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_reservation_body)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6f22b759-f7ca-4f6d-a46e-8e58f6ae3e78" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Topology Information header</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;topology information&apos; header</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="e9a6f829-cc84-4559-9f5a-d40fa5667f91" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_topology_header_prim = &quot;&lt;bgcolor=\\&quot;darkblue\\&quot;&gt;&lt;tr&gt;&lt;th style=\\&quot;color:white\\&quot;&gt;Topology Information&lt;/th&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="86167963-fb58-4e36-b74a-69be3c84cb43" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_topology_header_sec = &quot;&lt;tr bgcolor=\\&quot;lightblue\\&quot;&gt;&lt;td&gt;Topology Name&lt;/td&gt;&lt;td&gt;Author&lt;/td&gt;&lt;td&gt;Description&lt;/td&gt;&lt;td&gt;Tags&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0a85b0ff-90b9-421a-bbcc-9632e6c36cdf" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_topology_header_prim)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9a95a6d3-6521-484e-b146-87cfd8afc068" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_topology_header_sec)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="60649b36-f5a8-4ac0-b93e-aa1663f76e88" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Topology Information body</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;topology information&apos; body</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="43b4a490-120b-4557-8ee8-d51fd86e974a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_topology_body = &quot;&lt;tr bgcolor=\\&quot;white\\&quot;&gt;&lt;td&gt;&quot; + str(topology_name) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(topology_author) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(topology_description) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(tags) + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="90df44e6-09e9-42bf-9487-a4968c609c21" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_topology_body)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="cf233343-fded-442f-86ca-271d12817c9d" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Resources Information header</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;resources information&apos; header</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="8ebb1524-11f0-4592-975d-c206cd0fb4ab" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_resources_header_prim = &quot;&lt;bgcolor=\\&quot;darkblue\\&quot;&gt;&lt;tr&gt;&lt;th style=\\&quot;color:white\\&quot;&gt;Resources Information&lt;/th&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1703b5e0-938f-4017-8e75-4a6cd0c58e2c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_resources_header_sec = &quot;&lt;tr bgcolor=\\&quot;lightblue\\&quot;&gt;&lt;td&gt;Resource Name&lt;/td&gt;&lt;td&gt;ipAddress&lt;/td&gt;&lt;td&gt;Ports&lt;/td&gt;&lt;td&gt;VLANs&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cd616def-1745-4408-88a2-e2cda9b0bbe4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_resources_header_prim)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0426d807-bfae-4fdb-acb7-beeaca0e82f2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_resources_header_sec)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="2456579a-5bd1-4083-ad73-31a7468114de" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Resources Information body</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;resources information&apos; body</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="72fbacee-d2b1-457e-be6d-16c73aab2f52" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>stack = list(backup_dict.items()); print(stack)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8cca98a2-f05b-43f6-89b8-673f812dc77e" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>key in backup_dict.keys():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="d321b781-cd54-40fb-a568-5049b428c7a5" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>report_resources_body = &quot;&lt;tr bgcolor=\\&quot;white\\&quot;&gt;&lt;td&gt;&quot; + str(key) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(backup_dict[key][&apos;ip_addr&apos;]) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(backup_dict[key][&apos;ports&apos;]) + &quot;&lt;/td&gt;&lt;td&gt;&quot; + str(backup_dict[key][&apos;vlans&apos;]) + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a60bb0ed-4cc4-498d-8960-e808bc00e9ed" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>f.write(report_resources_body)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ad645c8f-738a-467f-882b-d4ae8fc6f7b0" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Attachments Information header</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;attachments information&apos; header</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="8177db3d-dbba-4bb4-84ea-cf963b260e41" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_attach_header_prim = &quot;&lt;bgcolor=\\&quot;darkblue\\&quot;&gt;&lt;tr&gt;&lt;th style=\\&quot;color:white\\&quot;&gt;Configuration Information&lt;/th&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4fbd77e3-675f-4e68-b6e6-3fe4970d0695" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_attach_header_sec = &quot;&lt;tr bgcolor=\\&quot;lightblue\\&quot;&gt;&lt;td colspan = \\&quot;4\\&quot;&gt;Filenames Attached&lt;/td&gt;&lt;/tr&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cd774a79-4294-44fc-9337-80490fdd4987" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_attach_header_prim)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f088bb2b-a91a-4922-842d-150c68552fa2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_attach_header_sec)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d6efcca5-09d9-4ad6-acf6-b1b0c3cf4217" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Build report Attachments Information body</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- build report &apos;attachments information&apos; body</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="fff06721-4571-4c78-86c9-56476ba248ae" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_attach_body = &quot;&lt;tr bgcolor=\\&quot;white\\&quot;&gt;&lt;td colspan=\\&quot;4\\&quot;&gt;&quot; + str(attachments) + &quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="070c3364-6563-4ccb-9b52-4810dac2b2a6" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.write(report_attach_body)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="321427c0-8964-47d9-9db4-ac75a27eded5" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>f.close()</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="b0e163d9-acac-46cf-924a-8d3da6167bf7" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Send email to reservation owner</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>Send email to reservation owner:</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="0ebcf88d-47f2-43b5-b0d7-5c3aa3c733f0" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>print(report_html)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="4a8b6aec-9239-4859-b381-ffecd393c7d1" action="sleep">
                            <command>
                                <body>10</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="bd1f0d29-5774-46ac-bb96-163b54e1a887" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>f = open((report_html), &quot;r&quot;)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="1329ae7b-81cb-4e6f-b1b4-0fefaac351a0" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>content = f.read(); print(content)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c00728d6-1a49-4cc1-b2db-e2257db5e129" action="open" session="email" useFieldsInCommand="false">
                            <command>
                                <body>project://Utilitaries/session_profiles/email.ffsp</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionProperties type="com.fnfr.svt.applications.mail.MailSessionProperties">
                                    <smtpUrl inherit="false" sub="true">[email_smtp_server]</smtpUrl>
                                    <smtpUser inherit="false" sub="true">[email_user]</smtpUser>
                                    <smtpPassword inherit="false" sub="true" masked="false">[email_password]</smtpPassword>
                                    <sessionbuilderInitializeAction type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </sessionProperties>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                        <item guid="cee48557-9cac-4afa-942a-2cf4e0f1b9da" action="from" session="email">
                            <command>
                                <body>[email_send_from]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="0703f3da-8cc3-4adf-844a-8228a0f6ecde" action="to" session="email">
                            <command>
                                <body>[user_email]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7d6b2b93-c04b-4d76-b86b-c57820e76a56" action="contentType" session="email">
                            <command>
                                <body>text/html</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="1dd2ac48-ca2e-48ff-8982-85c810897aa4" action="subject" session="email">
                            <command>
                                <body>Velocity Reservation Backup Information Data ([exec_timestamp])</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="218f8fb8-e8d3-4016-a224-79f1b33cd082" action="write" session="email">
                            <command>
                                <body>[content]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="414773bc-bc84-4092-b144-d88ced365ffc" action="attach" session="email">
                            <command>
                                <body>[backup_directory][backup_zip]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ea2331d4-1aed-44e4-a703-b308bd5450c0" action="send" session="email">
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="00639940-5fcc-41a6-8b4a-1818c5572e28" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Cleanup</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>Cleanup:</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="c83d5680-51ba-46a5-8ded-756c88b1d1f7" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Delete zip archive</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- delete zip archive</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="4fe5b46b-e30a-418a-9891-5ded63fe3d94" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.chdir(backup_directory)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f68cb8b3-9d0c-4e6a-a1dc-6d9a711c9a73" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>nwd = os.getcwd(); print(nwd)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a88bf6a8-5bc1-4d11-9916-a6f08cb56ddd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.remove(backup_zip)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d3ca598f-19d0-4a2e-8595-4c80b3394cbc" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Delete report folder</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>--- delete report folder</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <nestedSteps>
                                <item guid="8d500ec4-169e-4a38-8b35-1107e167a47a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(report_path)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a1497ba1-3709-48fa-81ab-daf373b21104" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>report_path_all = str(report_path) + &quot;/*&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a93455f8-fbcd-4efc-b3da-9d3945446341" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>import glob</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c9d2b63b-5365-4016-bea7-43f5cb60bef9" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>files = glob.glob(report_path_all)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="86490162-da81-49ce-b644-25edb5edee05" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>f in files:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="ef82242a-f47c-42f0-8006-70e23756eb7a" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>os.remove(f)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="65124397-8036-463a-a1a0-08f65685e239" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>os.rmdir(report_path)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
        </item>
    </procedures>
</testCase>
